{% extends 'layout.html' %}
{% block title %}Thành viên{% endblock %}
{% block content %}
<h3>Thành viên</h3>
<div class="card mb-4">
  <div class="card-body">
    {% if errors %}
      <div class="alert alert-danger">
        <ul class="mb-0">
          {% for e in errors %}<li>{{ e }}</li>{% endfor %}
        </ul>
      </div>
    {% endif %}
    <form method="post" action="{{ url_for('members.add_member') }}">
      <div class="row">
        <div class="col-md-4"><input class="form-control" name="name" placeholder="Tên" required value="{{ form.name if form and form.name is not none else '' }}"></div>
        <div class="col-md-4"><input class="form-control" name="email" placeholder="Email" value="{{ form.email if form and form.email is not none else '' }}"></div>
        <div class="col-md-3">
          <select class="form-select" name="team_id">
            <option value="">-- Nhóm --</option>
            {% for t in teams %}
              <option value="{{ t.id }}" {% if form and form.team_id and form.team_id|int == t.id %}selected{% endif %}>{{ t.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-1"><button class="btn btn-success">Thêm</button></div>
      </div>
    </form>
  </div>
</div> 

<table class="table table-striped">
  <thead><tr><th>#</th><th>Tên</th><th>Email</th><th>Nhóm</th><th>Hành động</th></tr></thead>
  <tbody>
    {% for m in members %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ m.name }}</td>
        <td>{{ m.email }}</td>
        <td>{{ m.team.name if m.team else '' }}</td>
        <td>
          <a class="btn btn-sm btn-secondary" href="{{ url_for('members.edit_member', id=m.id) }}">Sửa</a>
          <form method="post" action="{{ url_for('members.delete_member', id=m.id) }}" style="display:inline; margin-left:6px">
            <button class="btn btn-sm btn-danger" onclick="return confirm('Xóa?')">Xóa</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}